var q=Object.defineProperty;var z=(t,e,s)=>e in t?q(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var n=(t,e,s)=>(z(t,typeof e!="symbol"?e+"":e,s),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(r){if(r.ep)return;r.ep=!0;const o=s(r);fetch(r.href,o)}})();let f=Object.getPrototypeOf,_,b,d,g,j={isConnected:1},B=1e3,y,W={},J=f(j),A=f(f),u,M=(t,e,s,l)=>(t??(setTimeout(s,l),new Set)).add(e),I=(t,e,s)=>{let l=d;d=e;try{return t(s)}catch(r){return console.error(r),s}finally{d=l}},S=t=>t.filter(e=>{var s;return(s=e._dom)==null?void 0:s.isConnected}),T=t=>y=M(y,t,()=>{for(let e of y)e._bindings=S(e._bindings),e._listeners=S(e._listeners);y=u},B),O={get val(){var t;return(t=d==null?void 0:d._getters)==null||t.add(this),this.rawVal},get oldVal(){var t;return(t=d==null?void 0:d._getters)==null||t.add(this),this._oldVal},set val(t){var e;(e=d==null?void 0:d._setters)==null||e.add(this),t!==this.rawVal&&(this.rawVal=t,this._bindings.length+this._listeners.length?(b==null||b.add(this),_=M(_,this,R)):this._oldVal=t)}},F=t=>({__proto__:O,rawVal:t,_oldVal:t,_bindings:[],_listeners:[]}),w=(t,e)=>{let s={_getters:new Set,_setters:new Set},l={f:t},r=g;g=[];let o=I(t,s,e);o=(o??document).nodeType?o:new Text(o);for(let i of s._getters)s._setters.has(i)||(T(i),i._bindings.push(l));for(let i of g)i._dom=o;return g=r,l._dom=o},k=(t,e=F(),s)=>{let l={_getters:new Set,_setters:new Set},r={f:t,s:e};r._dom=s??(g==null?void 0:g.push(r))??j,e.val=I(t,l,e.rawVal);for(let o of l._getters)l._setters.has(o)||(T(o),o._listeners.push(r));return e},N=(t,...e)=>{for(let s of e.flat(1/0)){let l=f(s??0),r=l===O?w(()=>s.val):l===A?w(s):s;r!=u&&t.append(r)}return t},$=(t,e,...s)=>{var i;let[l,...r]=f(s[0]??0)===J?s:[{},...s],o=t?document.createElementNS(t,e):document.createElement(e);for(let[h,a]of Object.entries(l)){let p=m=>m?Object.getOwnPropertyDescriptor(m,h)??p(f(m)):u,H=e+","+h,V=W[H]??(W[H]=((i=p(f(o)))==null?void 0:i.set)??0),P=h.startsWith("on")?(m,K)=>{let x=h.slice(2);o.removeEventListener(x,K),o.addEventListener(x,m)}:V?V.bind(o):o.setAttribute.bind(o,h),v=f(a??0);h.startsWith("on")||v===A&&(a=k(a),v=O),v===O?w(()=>(P(a.val,a._oldVal),o)):P(a)}return N(o,...r)},X=t=>({get:(e,s)=>$.bind(u,t,s)}),Q=new Proxy(t=>new Proxy($,X(t)),X()),G=(t,e)=>e?e!==t&&t.replaceWith(e):t.remove(),R=()=>{let t=0,e=[..._].filter(l=>l.rawVal!==l._oldVal);do{b=new Set;for(let l of new Set(e.flatMap(r=>r._listeners=S(r._listeners))))k(l.f,l.s,l._dom),l._dom=u}while(++t<100&&(e=[...b]).length);let s=[..._].filter(l=>l.rawVal!==l._oldVal);_=u;for(let l of new Set(s.flatMap(r=>r._bindings=S(r._bindings))))G(l._dom,w(l.f,l._dom)),l._dom=u;for(let l of s)l._oldVal=l.rawVal},U=(t,e)=>G(t,w(e,t));const L={add:N,tags:Q,state:F,derive:k,hydrate:U},D=t=>{for(let e=t.length-1;e>0;e--){const s=Math.floor(Math.random()*(e+1)),l=t[e];t[e]=t[s],t[s]=l}return t},Y=D(["success","primary","danger","info","warning","secondary","dark"]);class Z{constructor(e){n(this,"target");n(this,"handlers",[]);n(this,"scrollHandler");n(this,"bottomLock",!1);n(this,"topLock",!1);n(this,"leftLock",!1);n(this,"rightLock",!1);n(this,"lastScrollX",0);n(this,"lastScrollY",0);n(this,"bottomOffset",20);n(this,"topOffset",20);n(this,"leftOffset",0);n(this,"rightOffset",0);this.target=e}on(e,s){this.handlers.push([e,s]),this.updateScrollHandler()}updateScrollHandler(){this.scrollHandler&&this.target.removeEventListener("scroll",this.scrollHandler),this.scrollHandler=e=>{const s=this.getScrollInfo();this.handlers.forEach(([l,r])=>{switch(l){case"bottom":if(this.bottomLock||s.scrollY==this.lastScrollY)return;s.height-(s.scrollY+s.clientHeight)<=this.bottomOffset&&r(e);break;case"top":if(this.topLock||s.scrollY==this.lastScrollY)return;s.scrollY<=this.topOffset&&r(e);break;case"left":if(this.leftLock||s.clientWidth==s.width||s.scrollX==this.lastScrollX)return;s.scrollX<=this.leftOffset&&r(e);break;case"right":if(this.rightLock||s.clientWidth==s.width||s.scrollX==this.lastScrollX)return;s.width-(s.scrollX+s.clientWidth)<=this.rightOffset&&r(e);break}}),this.lastScrollX=s.scrollX,this.lastScrollY=s.scrollY},this.target.addEventListener("scroll",this.scrollHandler)}getScrollInfo(){return this.target instanceof Window?{scrollX:this.target.scrollX,scrollY:this.target.scrollY,width:document.body.offsetWidth,height:document.body.offsetHeight,clientWidth:window.innerWidth,clientHeight:window.innerHeight}:{scrollX:this.target.scrollLeft,scrollY:this.target.scrollTop,width:this.target.scrollWidth,height:this.target.scrollHeight,clientWidth:this.target.clientWidth,clientHeight:this.target.clientHeight}}off(e){this.handlers=this.handlers.filter(s=>s[1]!=e),this.updateScrollHandler()}}const{a:tt,button:et,div:c,img:st}=L.tags,lt=()=>{const t=c({class:"tags hide-scrollbar d-flex gap-2 py-3 py-sm-4 sticky-top overflow-auto"}),e=c({class:"images row gy-4"});return rt(t,e),c({class:"container py-4 py-md-5"},c({class:"hstack"},c({class:"fs-3 fw-bold me-auto title"},c({class:"d-inline text-danger"},"不要害羞"),c({class:"d-inline text-success"}," 图片网")),tt({href:"https://github.com/iuroc/haixiu",class:"link-secondary",target:"_blank"},"Github")),t,e)},rt=async(t,e)=>{const s=await fetch("./datas/init.json").then(a=>a.json());L.add(t,s.allTags.map((a,p)=>et({class:`btn btn-${Y[p%Y.length]} text-nowrap`},a)));const l=Array.from({length:s.totalPage},(a,p)=>p),r=D(l),o=await C(r[0]);E(e,o.list,!1);const i=new Z(window);i.bottomOffset=100;let h=0;i.on("bottom",async()=>{i.bottomLock=!0;const a=await C(r[++h]);E(e,a.list,!0),i.bottomLock=!1})},C=async t=>await fetch(`./datas/data_${t}.json`).then(e=>e.json()),ot=t=>c({class:"card",role:"button",onclick(){open(`./images/${t.bigImageFilename}`)}},c({class:"ratio ratio-1x1"},st({class:"card-img-top",style:"pointer-events: none;",alt:t.title,src:`./images/${t.imageFilename}`})),c({class:"card-body"},c({class:"card-title text-truncate fw-bold"},t.title),c({class:"date card-text text-nowrap text-muted"},t.date))),E=(t,e,s=!0)=>{s||(t.innerHTML=""),L.add(t,e.map(l=>c({class:"col-xl-3 col-lg-4 col-6"},ot(l))))};L.add(document.body,lt());
